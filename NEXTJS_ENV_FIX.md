# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: API key –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Next.js

## –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞ `401 Unauthorized: Invalid API key` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:
1. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `NEXT_PUBLIC_BOT_API_KEY` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–ª–∏ –Ω–µ –≤–∏–¥–Ω–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. Next.js –Ω—É–∂–Ω–æ **–ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –í–∞–∂–Ω–æ –æ Next.js –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í Next.js –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `NEXT_PUBLIC_` **–≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏** (`npm run build`). 

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- ‚ùå –ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
- ‚úÖ –ù—É–∂–Ω–æ **–ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

## –†–µ—à–µ–Ω–∏–µ

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

–í `.env.local` –∏–ª–∏ `.env` —Ñ–∞–π–ª–µ Next.js –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–µ –≤ `/var/www/backend/backend/.env`!):

```bash
NEXT_PUBLIC_BOT_API_BASE=https://webhook.glco.us/api
NEXT_PUBLIC_BOT_API_KEY=aB3cD4eF5gH6iJ7kL8mN9oP0qR1sT2uV3wX4yZ5aB6cD7eF8gH9iJ0kL1mN2oP3
```

**–í–∞–∂–Ω–æ:** –§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –∫–æ—Ä–Ω–µ Next.js –ø—Ä–æ–µ–∫—Ç–∞, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è `package.json` –∏ `next.config.ts`.

### 2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ Next.js –ø—Ä–æ–µ–∫—Ç

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é Next.js –ø—Ä–æ–µ–∫—Ç–∞
cd /path/to/nextjs/project

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart nextjs-app
# –∏–ª–∏
pm2 restart all
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `https://glco.us/internal-driver-portal-7v92nx/oil-change`
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ—à–∏–±–∫–∞ –∏—Å—á–µ–∑–ª–∞

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã:
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
console.log(process.env.NEXT_PUBLIC_BOT_API_BASE)
console.log(process.env.NEXT_PUBLIC_BOT_API_KEY)
```

–ï—Å–ª–∏ –≤—ã–≤–æ–¥–∏—Ç `undefined`, –∑–Ω–∞—á–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –≤—Å—Ç—Ä–æ–∏–ª–∏—Å—å –≤ bundle - –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å.

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Network tab

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network
2. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `/api/oil-change/list`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Request Headers - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-API-Key`

–ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –Ω–µ—Ç –∏–ª–∏ –æ–Ω –ø—É—Å—Ç–æ–π, –∑–Ω–∞—á–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.

## –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è Next.js –ø—Ä–æ–µ–∫—Ç?

–û–±—ã—á–Ω–æ Next.js –ø—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤:
- `/var/www/logistics/` (–µ—Å–ª–∏ —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)
- –ò–ª–∏ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Ä—è–¥–æ–º —Å backend

–ù–∞–π–¥–∏—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å `package.json` –∏ `next.config.ts` - —Ç–∞–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `.env.local` —Ñ–∞–π–ª.
